{"remainingRequest":"e:\\练习\\第四阶段 小程序\\Vue-ul\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js!e:\\练习\\第四阶段 小程序\\Vue-ul\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!e:\\练习\\第四阶段 小程序\\Vue-ul\\vue_app_00\\src\\components\\home\\NewsInfo.vue?vue&type=script&lang=js","dependencies":[{"path":"e:\\练习\\第四阶段 小程序\\Vue-ul\\vue_app_00\\src\\components\\home\\NewsInfo.vue","mtime":1552284715802},{"path":"e:\\练习\\第四阶段 小程序\\Vue-ul\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"e:\\练习\\第四阶段 小程序\\Vue-ul\\vue_app_00\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"e:\\练习\\第四阶段 小程序\\Vue-ul\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Toast } from \"mint-ui\";\nexport default {\n  data: function data() {\n    return {\n      nid: this.$route.query.nid,\n      info: {},\n      //新闻的详细对象\n      msg: \"\",\n      //获取的评论\n      list: [],\n      //评论的内容\n      pno: 0,\n      //页码\n      pageSize: 5 //页大小\n\n    };\n  },\n  created: function created() {\n    this.findNewsInfo();\n    this.loadMore();\n  },\n  methods: {\n    //查询新闻的详细信息\n    findNewsInfo: function findNewsInfo() {\n      var _this = this;\n\n      //1.获取新闻编号\n      var id = this.nid; //2.创建url保存请求地址\n\n      var url = \"http://127.0.0.1:3000/newsInfo?nid=\" + id; //3.发送ajax请求\n\n      this.axios.get(url).then(function (result) {\n        //4.获取服务器返回数据保存 info\n        _this.info = result.data.data[0];\n      });\n    },\n    addComment: function addComment() {\n      var _this2 = this;\n\n      //添加评论\n      //1:评论内容双向绑定\n      //2:评论按钮绑定点击时间调用addComment\n      //3:获取新闻nid 获取评论内容\n      var nid = this.nid;\n      var con = this.msg; //console.log(nid+\":\"+con);\n      //4:去除评论两端空格\n\n      var size = con.trim().length; //5:如果评论为空提示判断\n\n      if (size == 0) {\n        Toast(\"评论内容不能为空\");\n        return;\n      } //6:创建postData保存新闻nid评论内容\n\n\n      var postData = this.qs.stringify({\n        nid: nid,\n        content: con\n      }); //console.log(postData);\n      //7:发送post请求欧/addComment\n\n      var url = \"http://127.0.0.1:3000/addcomment\";\n      this.axios.post(url, postData).then(function (result) {\n        //8:获取返回结果\n        Toast(\"添加成功\"); //9:评论成功或失败 消息\n        //10:清空原有评论内容\n\n        _this2.msg = \" \"; //11:加载评论列表\n\n        _this2.pno = 0; //清空页码\n\n        _this2.list = []; //清空原有数据\n\n        _this2.loadMore(); //第一页\n\n      });\n    },\n    //更多评论\n    loadMore: function loadMore() {\n      var _this3 = this;\n\n      //1:在data 添加几个数据\n      //list:[] pno:0 pageSize:5\n      //2:获取pno,pageSize\n      this.pno++;\n      var ps = this.pageSize; //3:正则表达式验证pno和pageSize是否正确\n\n      var reg = /^[0-9]{1,}$/; //4:如果不正确提示\n\n      if (!reg.test(this.pno)) {\n        Toast(\"页码格式不正确\");\n        return;\n      } //console.log(this.pno+\":\"+ps);\n      //5:创建url 发送ajax请求\n\n\n      var url = \"http://127.0.0.1:3000/getComment?nid=\" + this.nid + \"&pno=\" + this.pno;\n      this.axios.get(url).then(function (result) {\n        //6:获取返回内容\n        //7:保存list\n        _this3.list = result.data.data;\n      });\n    }\n  }\n};",{"version":3,"sources":["NewsInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA,SAAA,KAAA,QAAA,SAAA;AACA,eAAA;AACA,MADA,kBACA;AACA,WAAA;AACA,WAAA,KAAA,MAAA,CAAA,KAAA,CAAA,GADA;AAEA,YAAA,EAFA;AAEA;AACA,WAAA,EAHA;AAGA;AACA,YAAA,EAJA;AAIA;AACA,WAAA,CALA;AAKA;AACA,gBAAA,CANA,CAMA;;AANA,KAAA;AAQA,GAVA;AAWA,SAXA,qBAWA;AACA,SAAA,YAAA;AACA,SAAA,QAAA;AACA,GAdA;AAeA,WAAA;AACA;AACA,gBAFA,0BAEA;AAAA;;AACA;AACA,UAAA,KAAA,KAAA,GAAA,CAFA,CAGA;;AACA,UAAA,MAAA,wCAAA,EAAA,CAJA,CAKA;;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,GAAA,EAAA,IAAA,CAAA,kBAAA;AACA;AACA,cAAA,IAAA,GAAA,OAAA,IAAA,CAAA,IAAA,CAAA,CAAA,CAAA;AACA,OAHA;AAIA,KAZA;AAcA,cAdA,wBAcA;AAAA;;AACA;AACA;AACA;AACA;AACA,UAAA,MAAA,KAAA,GAAA;AACA,UAAA,MAAA,KAAA,GAAA,CANA,CAOA;AACA;;AACA,UAAA,OAAA,IAAA,IAAA,GAAA,MAAA,CATA,CAUA;;AACA,UAAA,QAAA,CAAA,EAAA;AACA,cAAA,UAAA;AACA;AACA,OAdA,CAeA;;;AACA,UAAA,WAAA,KAAA,EAAA,CAAA,SAAA,CAAA;AACA,aAAA,GADA;AAEA,iBAAA;AAFA,OAAA,CAAA,CAhBA,CAoBA;AACA;;AACA,UAAA,MAAA,kCAAA;AACA,WAAA,KAAA,CAAA,IAAA,CAAA,GAAA,EAAA,QAAA,EAAA,IAAA,CAAA,kBAAA;AACA;AACA,cAAA,MAAA,EAFA,CAGA;AACA;;AACA,eAAA,GAAA,GAAA,GAAA,CALA,CAMA;;AACA,eAAA,GAAA,GAAA,CAAA,CAPA,CAOA;;AACA,eAAA,IAAA,GAAA,EAAA,CARA,CAQA;;AACA,eAAA,QAAA,GATA,CASA;;AACA,OAVA;AAWA,KAhDA;AAiDA;AACA,YAlDA,sBAkDA;AAAA;;AACA;AACA;AACA;AACA,WAAA,GAAA;AACA,UAAA,KAAA,KAAA,QAAA,CALA,CAMA;;AACA,UAAA,MAAA,aAAA,CAPA,CAQA;;AACA,UAAA,CAAA,IAAA,IAAA,CAAA,KAAA,GAAA,CAAA,EAAA;AACA,cAAA,SAAA;AACA;AACA,OAZA,CAaA;AACA;;;AACA,UAAA,MAAA,0CAAA,KAAA,GAAA,GAAA,OAAA,GAAA,KAAA,GAAA;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,GAAA,EAAA,IAAA,CAAA,kBAAA;AACA;AACA;AACA,eAAA,IAAA,GAAA,OAAA,IAAA,CAAA,IAAA;AACA,OAJA;AAMA;AAxEA;AAfA,CAAA","sourcesContent":["<template>\r\n    <div class=\"app-newsinfo\">\r\n        <!----新闻详情---->\r\n        <div class=\"mui-card\">\r\n            <div class=\"mui-card-header mui-card-media\" :style=\"'height:40vw;background-image:url('+info.img_url+')'\"></div>\r\n            <div class=\"mui-card-content\">\r\n                <div class=\"mui-card-content-inner\">\r\n                    <p>{{info.ctime | dateTimeFilter}}</p>\r\n                    <p style=\"color: #333;\">{{info.content}}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"mui-card-footer\">\r\n                <a class=\"mui-card-link\">Like</a>\r\n                <a class=\"mui-card-link\">Read more</a>\r\n            </div>\r\n            <!--新闻评论-->\r\n            <div class=\"mui-card\">\r\n\t\t\t\t<div class=\"mui-card-header\"></div>\r\n\t\t\t\t<div class=\"mui-card-content\">\r\n\t\t\t\t\t<div class=\"mui-card-content-inner\">\r\n\t\t\t\t\t\t<textarea maxlength=\"120\" placeholder=\"请吐槽最多120个字\" v-model=\"msg\">\r\n                        </textarea>\r\n                        <mt-button size=\"large\" type=\"primary\" @click=\"addComment\">发表评论</mt-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"mui-card-footer\"></div>\r\n\t\t\t</div>\r\n        </div>\r\n        \r\n        <!-- 新闻发表评论  end -->\r\n        <!-- 新闻评论列表   staart -->\r\n        <div class=\"mui-card\">\r\n            <div class=\"mui-card-content\">\r\n                <div class=\"mui-card-content-inner\">\r\n                    <div class=\"cmt-list\">\r\n                        <div class=\"cmt-item\" v-for=\"(item,i) of list\">\r\n                            <div>第{{i+1}}楼 发表时间:{{item.ctime | dateTimeFilter}}</div>\r\n                            <div>评论内容:{{item.content}}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <!-- 新闻评论列表  end -->\r\n\r\n         <!--加载更多..-->\r\n         <mt-button @click=\"loadMore\" size=\"large\" type=\"primary\">加载更多</mt-button>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {Toast} from \"mint-ui\"\r\nexport default {\r\n    data(){\r\n        return {\r\n            nid:this.$route.query.nid,\r\n            info:{}, //新闻的详细对象\r\n            msg:\"\",//获取的评论\r\n            list:[], //评论的内容\r\n            pno:0,   //页码\r\n            pageSize:5, //页大小\r\n        }\r\n    },\r\n    created(){\r\n       this.findNewsInfo();\r\n       this.loadMore();\r\n    },\r\n    methods:{\r\n        //查询新闻的详细信息\r\n        findNewsInfo(){\r\n            //1.获取新闻编号\r\n                var id=this.nid;\r\n            //2.创建url保存请求地址\r\n            var url=\"http://127.0.0.1:3000/newsInfo?nid=\"+id;\r\n            //3.发送ajax请求\r\n            this.axios.get(url).then(result=>{\r\n                //4.获取服务器返回数据保存 info\r\n                this.info=result.data.data[0];\r\n            })   \r\n        },\r\n        \r\n       addComment(){\r\n            //添加评论\r\n            //1:评论内容双向绑定\r\n            //2:评论按钮绑定点击时间调用addComment\r\n            //3:获取新闻nid 获取评论内容\r\n            var nid=this.nid;\r\n            var con=this.msg;\r\n            //console.log(nid+\":\"+con);\r\n            //4:去除评论两端空格\r\n            var size = con.trim().length;\r\n            //5:如果评论为空提示判断\r\n            if(size==0){\r\n                Toast(\"评论内容不能为空\");\r\n                return;\r\n            }\r\n            //6:创建postData保存新闻nid评论内容\r\n            var postData = this.qs.stringify({\r\n                nid:nid,\r\n                content:con\r\n            });\r\n                //console.log(postData);\r\n            //7:发送post请求欧/addComment\r\n            var url = \"http://127.0.0.1:3000/addcomment\";\r\n            this.axios.post(url,postData).then(result=>{\r\n            //8:获取返回结果\r\n            Toast(\"添加成功\");\r\n            //9:评论成功或失败 消息\r\n            //10:清空原有评论内容\r\n            this.msg=\" \";\r\n            //11:加载评论列表\r\n            this.pno=0;    //清空页码\r\n            this.list=[];  //清空原有数据\r\n            this.loadMore();  //第一页\r\n            })\r\n        },\r\n        //更多评论\r\n        loadMore(){\r\n            //1:在data 添加几个数据\r\n            //list:[] pno:0 pageSize:5\r\n            //2:获取pno,pageSize\r\n            this.pno++;\r\n            var ps=this.pageSize;\r\n            //3:正则表达式验证pno和pageSize是否正确\r\n            var reg=/^[0-9]{1,}$/;\r\n            //4:如果不正确提示\r\n            if(!reg.test(this.pno)){\r\n                Toast(\"页码格式不正确\");\r\n                return;\r\n            }\r\n            //console.log(this.pno+\":\"+ps);\r\n            //5:创建url 发送ajax请求\r\n            var url=\"http://127.0.0.1:3000/getComment?nid=\"+this.nid+\"&pno=\"+this.pno;\r\n            this.axios.get(url).then(result=>{\r\n                //6:获取返回内容\r\n                //7:保存list\r\n                this.list=result.data.data;\r\n            })\r\n\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"],"sourceRoot":"src\\components\\home"}]}